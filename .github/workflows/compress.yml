name: Convert to HEVC Alpha
on: push

jobs:
  convert:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Download from Google Drive
        run: |
          pip install gdown
          gdown "1H2Bj4BDB7Po3gSV9M29rgS8ECJagFu2-" -O "input.mov"
      
      - name: Install ffmpeg
        run: brew install ffmpeg
      
      - name: Convert to HEVC Alpha
        run: |
          ffmpeg -i "input.mov" \
            -c:v hevc_videotoolbox \
            -allow_sw 1 \
            -alpha_quality 0.75 \
            -b:v 2000k \
            -tag:v hvc1 \
            "output.mov"
      
      - uses: actions/upload-artifact@v4
        with:
          name: output
          path: output.mov
